<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events</title>
    <link rel="stylesheet" href="style.css">
    <script defer src="./Scripts/firebase-init.js"></script>
    <script defer src="./Scripts/events.js"></script>
</head>
<body>
    <header>
        <h1>Available Events</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="cart.html">Cart</a>
            <a href="logout.html">Logout</a>
        </nav>
    </header>
    <main>
        <section class="event-list" id="event-list">
            <div class="event">
                <h2>Event 1</h2>
                <p>Details about Event 1.</p>
                <button onclick="location.href='view-details.html?event=1'">View Details</button>
                <button onclick="location.href='register.html?event=1'">Register</button>
                <button onclick="location.href='cart.html?event=1'">Add To Cart</button>
            </div>
            <div class="event">
                <h2>Event 2</h2>
                <p>Details about Event 2.</p>
                <button onclick="location.href='view-details.html?event=2'">View Details</button>
                <button onclick="location.href='register.html?event=2'">Register</button>
                <button onclick="location.href='cart.html?event=2'">Add To Cart</button>
            </div>
        </section>
        <div id="eventContainer" class="event-cards"></div>

        <!-- <section class="create-event">
            <h2>Create New Event</h2>
            <form id="create-event-form">
                <label for="event-title">Event Title:</label>
                <input type="text" id="event-title" name="event-title" required>
                <label for="event-details">Event Details:</label>
                <textarea id="event-details" name="event-details" required></textarea>
                <button type="submit">Create Event</button>
            </form>
        </section> -->
    </main>
    <script>
        // document.getElementById('create-event-form').addEventListener('submit', function(event) {
        //     event.preventDefault();
        //     const eventTitle = document.getElementById('event-title').value;
        //     const eventDetails = document.getElementById('event-details').value;
            
        //     const newEvent = document.createElement('div');
        //     newEvent.classList.add('event');
        //     newEvent.innerHTML = `
        //         <h2>${eventTitle}</h2>
        //         <p>${eventDetails}</p>
        //         <button onclick="location.href='view-details.html?event=${eventTitle}'">View Details</button>
        //         <button onclick="location.href='register.html?event=${eventTitle}'">Register</button>
        //         <button onclick="location.href='cart.html?event=${eventTitle}'">Add To Cart</button>
        //     `;
            
        //     document.getElementById('event-list').appendChild(newEvent);
            
        //     document.getElementById('create-event-form').reset();
        // });


// // Fetch all documents from Firestore
 async function fetchEvents() {
     const url = `https://firestore.googleapis.com/v1/projects/${projectId}/databases/(default)/documents/${collectionName}?key=${apiKey}`;
     const response = await fetch(url);

    if (response.ok) {
         const data = await response.json();
         displayEvents(data.documents || []);
     } else {
         console.error("Error fetching events:", await response.text());
     }
 }

// Display fetched events
function displayEvents(documents) {
    eventContainer.innerHTML = ""; // Clear current content
    documents.forEach((doc) => {
        const fields = doc.fields;
        const id = doc.name.split("/").pop(); // Extract document ID

        const card = document.createElement("div");
        card.className = "event-card";
        card.innerHTML = `
            <h3>${fields.title?.stringValue}</h3>
            <p><strong>Date:</strong> ${fields.date?.stringValue}</p>
            <p><strong>Time:</strong> ${fields.time?.stringValue}</p>
            <p><strong>Location:</strong> ${fields.location?.stringValue}</p>
            <p><strong>Description:</strong> ${fields.description?.stringValue}</p>
            <p><strong>Tickets:</strong> ${fields.tickets?.integerValue}</p>
            <p><strong>Price:</strong> $${fields.price?.doubleValue.toFixed(2)}</p>
            <button onclick="viewDetails('${id}')">View Details</button>
            <button onclick="register('${id}')">Register</button>
            <button onclick="addCart('${id}')">Add to cart</button>
        `;
        eventContainer.appendChild(card);
    });
}
// Fetch and display events on page load
document.addEventListener("DOMContentLoaded", fetchEvents);
    </script>
    
</body>
</html>
